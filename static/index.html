<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™®æºç¤ºæ³¢å™¨å®æ—¶æ³¢å½¢æ˜¾ç¤ºç³»ç»Ÿ</title>
    <link rel="stylesheet" href="style.css">
    <!-- åº”åŠ›æ¨¡å—æ ·å¼ï¼ˆæ‹†åˆ†åï¼‰ -->
    <link rel="stylesheet" href="css/stress-calibration.css">
    <link rel="stylesheet" href="css/stress-common.css">
    <!-- åº”åŠ›åœºæµ‹ç»˜æ¨¡å—æ ·å¼ï¼ˆæŒ‰åŠŸèƒ½æ‹†åˆ†ï¼‰ -->
    <link rel="stylesheet" href="css/stress-detection-uniaxial/layout.css">
    <link rel="stylesheet" href="css/stress-detection-uniaxial/panels.css">
    <link rel="stylesheet" href="css/stress-detection-uniaxial/capture.css">
    <link rel="stylesheet" href="css/stress-detection-uniaxial/display.css">
    <link rel="stylesheet" href="css/stress-detection-uniaxial/modals.css">
    <style>
        /* å¼€å±ç”»é¢æ ·å¼ */
        #splashScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 99999;
            transition: opacity 0.5s ease-out;
        }
        
        #splashScreen.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .splash-content {
            text-align: center;
            color: white;
            animation: splashFadeIn 0.6s ease-out;
        }
        
        @keyframes splashFadeIn {
            from { opacity: 0; transform: translateY(-30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }
        
        .splash-logo {
            font-size: 96px;
            margin-bottom: 30px;
            animation: splashPulse 2s ease-in-out infinite;
            filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.4));
        }
        
        @keyframes splashPulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.1); opacity: 0.85; }
        }
        
        .splash-title {
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 15px;
            letter-spacing: 3px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }
        
        .splash-subtitle {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.85);
            margin-bottom: 60px;
            letter-spacing: 1px;
        }
        
        .splash-loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            margin: 0 auto;
        }
        
        .splash-dot {
            width: 16px;
            height: 16px;
            background: #4CAF50;
            border-radius: 50%;
            animation: splashDotBounce 1.4s ease-in-out infinite;
            box-shadow: 0 0 15px rgba(76, 175, 80, 0.6);
        }
        
        .splash-dot:nth-child(1) {
            animation-delay: 0s;
            background: #4CAF50;
        }
        
        .splash-dot:nth-child(2) {
            animation-delay: 0.2s;
            background: #66BB6A;
        }
        
        .splash-dot:nth-child(3) {
            animation-delay: 0.4s;
            background: #8BC34A;
        }
        
        .splash-dot:nth-child(4) {
            animation-delay: 0.6s;
            background: #AED581;
        }
        
        .splash-dot:nth-child(5) {
            animation-delay: 0.8s;
            background: #C5E1A5;
        }
        
        @keyframes splashDotBounce {
            0%, 80%, 100% {
                transform: scale(0.8) translateY(0);
                opacity: 0.6;
            }
            40% {
                transform: scale(1.2) translateY(-20px);
                opacity: 1;
            }
        }
        
        .splash-loading-text {
            margin-top: 20px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .splash-version {
            position: absolute;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
            letter-spacing: 1px;
        }
    </style>
</head>
<body>
    <!-- å¼€å±ç”»é¢ -->
    <div id="splashScreen">
        <div class="splash-content">
            <div class="splash-logo">ğŸ“Š</div>
            <div class="splash-title">æ™®æºç¤ºæ³¢å™¨å®æ—¶æ³¢å½¢æ˜¾ç¤ºç³»ç»Ÿ</div>
            <div class="splash-subtitle">RIGOL Oscilloscope Waveform Display System</div>
            <div class="splash-loading-spinner">
                <div class="splash-dot"></div>
                <div class="splash-dot"></div>
                <div class="splash-dot"></div>
                <div class="splash-dot"></div>
                <div class="splash-dot"></div>
            </div>
            <div class="splash-loading-text">æ­£åœ¨åˆå§‹åŒ–ç³»ç»Ÿ<span class="dots"></span></div>
        </div>
        <div class="splash-version">v1.0.0 | Python + pywebview</div>
    </div>
    
    <div class="container">
        <!-- é¡¶éƒ¨æ ‡ç­¾æ  -->
        <div class="tab-bar">
            <button class="tab-btn active" data-tab="capture">ğŸ“Š å®æ—¶é‡‡é›†</button>
            <button class="tab-btn" data-tab="analysis">ğŸ“ˆ æ³¢å½¢åˆ†æ</button>
            <button class="tab-btn" data-tab="calibration">ğŸ”¬ åº”åŠ›ç³»æ•°æ ‡å®š</button>
            <button class="tab-btn" data-tab="detection">ğŸ” å•è½´åº”åŠ›æ£€æµ‹</button>
        </div>

        <!-- å®æ—¶é‡‡é›†é¡µé¢ -->
        <div id="captureTab" class="tab-content active">
        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <div class="main-content">
            <!-- å·¦ä¾§é…ç½®é¢æ¿ -->
            <div class="config-panel">
                <!-- è®¾å¤‡è¿æ¥æ§åˆ¶ -->
                <div class="device-controls">
                    <button id="searchBtn" class="btn btn-primary btn-device">ğŸ” æœç´¢è®¾å¤‡</button>
                    <button id="disconnectBtn" class="btn btn-danger btn-device" disabled>âœ• æ–­å¼€</button>
                </div>
                
                <div class="config-section">
                    <label class="config-label">å¯ç”¨è®¾å¤‡</label>
                    <select id="deviceSelect" class="config-select">
                        <option value="">è¯·å…ˆæœç´¢è®¾å¤‡</option>
                    </select>
                </div>

                <div class="config-section">
                    <h3 class="section-title">é‡‡é›†è®¾ç½®</h3>
                    
                    <label class="config-label">é€šé“</label>
                    <select id="channelSelect" class="config-select">
                        <option value="1">é€šé“ 1</option>
                        <option value="2">é€šé“ 2</option>
                        <option value="3">é€šé“ 3</option>
                        <option value="4">é€šé“ 4</option>
                    </select>

                    <label class="config-label">å­˜å‚¨æ·±åº¦</label>
                    <select id="memoryDepthSelect" class="config-select" disabled>
                        <option value="AUTO">AUTOï¼ˆè‡ªåŠ¨ï¼‰</option>
                        <option value="1k">1k</option>
                        <option value="10k" selected>10k</option>
                        <option value="100k">100k</option>
                        <option value="1M">1M</option>
                        <option value="10M">10M</option>
                        <option value="25M">25M</option>
                        <option value="50M">50M</option>
                        <option value="100M">100M</option>
                        <option value="125M">125M</option>
                        <option value="200M">200M</option>
                        <option value="250M">250M</option>
                    </select>

                    <label class="config-label">æ—¶åŸºï¼ˆTime/Divï¼‰</label>
                    <select id="timebaseSelect" class="config-select" disabled>
                        <option value="10e-9">10 ns/div</option>
                        <option value="20e-9">20 ns/div</option>
                        <option value="50e-9">50 ns/div</option>
                        <option value="100e-9">100 ns/div</option>
                        <option value="200e-9">200 ns/div</option>
                        <option value="500e-9">500 ns/div</option>
                        <option value="1e-6">1 Î¼s/div</option>
                        <option value="2e-6">2 Î¼s/div</option>
                        <option value="5e-6" selected>5 Î¼s/div</option>
                        <option value="10e-6">10 Î¼s/div</option>
                        <option value="20e-6">20 Î¼s/div</option>
                        <option value="50e-6">50 Î¼s/div</option>
                        <option value="100e-6">100 Î¼s/div</option>
                    </select>

                    <div class="button-group">
                        <button id="autoSetBtn" class="btn btn-secondary" disabled>è‡ªåŠ¨</button>
                        <button id="runBtn" class="btn btn-secondary" disabled>è¿è¡Œ</button>
                        <button id="stopScopeBtn" class="btn btn-secondary" disabled>åœæ­¢</button>
                    </div>
                </div>

                <button id="captureBtn" class="btn btn-primary btn-large" disabled>
                    â¬‡ é‡‡é›†æ³¢å½¢
                </button>
                
                <div class="btn-group">
                    <button id="saveBtn" class="btn btn-success btn-large" disabled>
                        ğŸ’¾ ä¿å­˜æ³¢å½¢
                    </button>
                    <button id="saveDropdownBtn" class="btn btn-success btn-dropdown" disabled>
                        â–¼
                    </button>
                    <div id="saveDropdownMenu" class="dropdown-menu">
                        <div class="dropdown-item" data-format="npy">ğŸ’¾ ä¿å­˜ä¸º NPY</div>
                        <div class="dropdown-item" data-format="csv">ğŸ“Š ä¿å­˜ä¸º CSV</div>
                    </div>
                </div>
            </div>

            <!-- å³ä¾§æ³¢å½¢æ˜¾ç¤ºåŒºåŸŸ -->
            <div class="waveform-panel">
                <!-- å®æ—¶çŠ¶æ€ä¿¡æ¯æ  -->
                <div class="waveform-status-bar">
                    <!-- å·¦ä¾§ï¼šå®æ—¶æ•°æ®æ˜¾ç¤º -->
                    <div class="status-bar-left">
                        <div class="status-bar-item">
                            <span class="status-bar-label">é€šé“:</span>
                            <span id="statusChannelValue" class="status-bar-value">CHAN1</span>
                        </div>
                        <div class="status-bar-item">
                            <span class="status-bar-label">é‡‡æ ·ç‡:</span>
                            <span id="sampleRateValue" class="status-bar-value">4.00 GSa/s</span>
                        </div>
                        <div class="status-bar-item">
                            <span class="status-bar-label">å­˜å‚¨æ·±åº¦:</span>
                            <span id="memoryDepthValue" class="status-bar-value">10M</span>
                        </div>
                        <div class="status-bar-item">
                            <span class="status-bar-label">æ—¶åŸº:</span>
                            <span id="timebaseValue" class="status-bar-value">50 ns/div</span>
                        </div>
                        <div class="status-bar-item">
                            <span class="status-bar-label">å‚ç›´æ¡£ä½:</span>
                            <span id="vScaleValue" class="status-bar-value">2.00 V/div (+1.0)</span>
                        </div>
                    </div>
                    
                    <!-- å³ä¾§ï¼šä¿¡æ¯æ˜¾ç¤ºåŒºåŸŸ -->
                    <div id="statusBarInfoPanel" class="status-bar-info-panel" style="display: none;">
                        <div id="statusBarInfoIcon" class="status-bar-info-icon">âœ…</div>
                        <div class="status-bar-info-content">
                            <div id="statusBarInfoText" class="status-bar-info-text">æ“ä½œæˆåŠŸ</div>
                            <div id="statusBarInfoDetail" class="status-bar-info-detail">è¯¦ç»†ä¿¡æ¯</div>
                        </div>
                    </div>
                </div>
                
                <!-- æ³¢å½¢æ˜¾ç¤ºä¸»ä½“ï¼šå·¦è¾¹canvas + å³è¾¹å‚ç›´æ§åˆ¶ -->
                <div class="waveform-display">
                    <div class="canvas-container">
                        <canvas id="waveformCanvas"></canvas>
                        <div id="statusMessage" class="status-message">è¯·å…ˆæœç´¢å¹¶è¿æ¥è®¾å¤‡</div>
                    </div>
                    

                </div>
                
                <!-- æ°´å¹³æ§åˆ¶æ¡ï¼ˆåº•éƒ¨ï¼‰ -->
                <div class="horizontal-controls">
                    <div class="h-control-group">
                        <button id="hLeftFastBtn" class="control-btn" title="å¿«é€Ÿå·¦ç§»">â—€â—€</button>
                        <button id="hLeftBtn" class="control-btn" title="å·¦ç§»">â—€</button>
                        <button id="hCenterBtn" class="control-btn center-btn" title="æ°´å¹³å›ä¸­">âŠ™ å›ä¸­</button>
                        <button id="hRightBtn" class="control-btn" title="å³ç§»">â–¶</button>
                        <button id="hRightFastBtn" class="control-btn" title="å¿«é€Ÿå³ç§»">â–¶â–¶</button>
                    </div>
                    <div class="v-scale-group">
                        <label>å‚ç›´çµæ•åº¦:</label>
                        <button id="vScaleDownBtn" class="control-btn" title="å‡å°æ¡£ä½å€¼">âˆ’</button>
                        <button id="vScaleUpBtn" class="control-btn" title="å¢å¤§æ¡£ä½å€¼">+</button>
                        <button id="vFineTuneBtn" class="control-btn" title="å¾®è°ƒæ¨¡å¼">å¾®è°ƒ</button>
                    </div>
                    <div class="reset-group">
                        <button id="vCenterBtn" class="control-btn center-btn" title="å‚ç›´å±…ä¸­">âŠ™ å‚ç›´å±…ä¸­</button>
                        <button id="resetViewBtn" class="control-btn reset-btn" title="æ¢å¤é»˜è®¤è§†å›¾">ğŸ”„ æ¢å¤é»˜è®¤</button>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <!-- æ³¢å½¢åˆ†æé¡µé¢ -->
        <div id="analysisTab" class="tab-content">
            <!-- é¡¶éƒ¨å·¥å…·æ  -->
            <div class="analysis-toolbar">
                <button id="selectFileBtn" class="btn btn-primary">ğŸ“‚ é€‰æ‹©æ–‡ä»¶</button>
                <span id="selectedFileName" class="file-name-display">æœªé€‰æ‹©æ–‡ä»¶</span>
                
                <!-- åŠŸèƒ½æŒ‰é’® -->
                <div style="margin-left: auto; display: flex; gap: 10px;">
                    <button id="denoisingBtn" class="btn btn-secondary">ğŸ”Š å°æ³¢é™å™ª</button>
                    <button id="hilbertBtn" class="btn btn-secondary">ğŸ“ˆ Hilbertå˜æ¢</button>
                    <button id="timeDiffBtn" class="btn btn-secondary">â±ï¸ æ—¶é—´å·®</button>
                    <button id="crossCorrBtn" class="btn btn-secondary">ğŸ”— äº’ç›¸å…³</button>
                </div>
            </div>
            
            <!-- ä¸»å†…å®¹åŒºåŸŸ -->
            <div id="analysisMainContainer" style="display: flex; flex: 1; overflow: hidden; gap: 10px;">
                <!-- å·¦ä¾§é…ç½®é¢æ¿ -->
                <div id="analysisSidebar" class="analysis-sidebar-left" style="display: none;">
                    <div class="sidebar-header">
                        <h3 id="sidebarTitle">é…ç½®</h3>
                        <button id="closeSidebarBtn" class="btn-close-sidebar" title="å…³é—­ä¾§è¾¹æ ">Ã—</button>
                    </div>
                    
                    <!-- å°æ³¢é™å™ªé¢æ¿ -->
                    <div id="denoisingPanel" class="analysis-panel" style="display: none;">
                        <div class="config-group">
                            <label>å°æ³¢ç±»å‹</label>
                            <select id="waveletType" class="config-input">
                                <option value="sym6">sym6</option>
                                <option value="db4">db4</option>
                                <option value="db5">db5</option>
                                <option value="coif2">coif2</option>
                            </select>
                        </div>
                        <div class="config-group">
                            <label>åˆ†è§£å±‚æ•°: <span id="decompLevelValue">5</span></label>
                            <input type="range" id="decompLevel" min="1" max="10" value="5" class="config-slider">
                        </div>
                        <div class="config-group">
                            <label>é˜ˆå€¼æ–¹æ³•</label>
                            <select id="thresholdMethod" class="config-input">
                                <option value="soft">è½¯é˜ˆå€¼</option>
                                <option value="hard">ç¡¬é˜ˆå€¼</option>
                            </select>
                        </div>
                        <div class="config-group">
                            <label>é˜ˆå€¼æ¨¡å¼</label>
                            <select id="thresholdMode" class="config-input">
                                <option value="heursure">Heursure</option>
                                <option value="universal">Universal</option>
                                <option value="minimax">Minimax</option>
                            </select>
                        </div>
                        <button id="applyDenoiseBtn" class="btn btn-primary btn-block">åº”ç”¨é™å™ª</button>
                        <button id="toggleViewBtn" class="btn btn-secondary btn-block" disabled>åˆ‡æ¢è§†å›¾</button>
                        <div id="denoiseResult" class="result-box" style="display: none;">
                            <p>é˜ˆå€¼: <span id="thresholdValue">--</span></p>
                            <p>å™ªå£°Ïƒ: <span id="sigmaValue">--</span></p>
                        </div>
                    </div>
                    
                    <!-- Hilbertå˜æ¢é¢æ¿ -->
                    <div id="hilbertPanel" class="analysis-panel" style="display: none;">
                        <div class="config-group">
                            <label>
                                <input type="checkbox" id="showOriginal" checked>
                                æ˜¾ç¤ºåŸå§‹ä¿¡å·
                            </label>
                        </div>
                        <div class="config-group">
                            <label>åŒ…ç»œçº¿é¢œè‰²</label>
                            <input type="color" id="envelopeColor" value="#ff6b6b" class="config-input">
                        </div>
                        <div class="config-group">
                            <label>çº¿å®½: <span id="widthValue">1</span></label>
                            <input type="range" id="envelopeWidth" min="1" max="5" value="1" class="config-slider">
                        </div>
                        <button id="applyHilbertBtn" class="btn btn-primary btn-block">åº”ç”¨Hilbert</button>
                        <button id="clearHilbertBtn" class="btn btn-secondary btn-block">æ¸…é™¤åŒ…ç»œ</button>
                    </div>
                    
                    <!-- æ—¶é—´å·®è®¡ç®—é¢æ¿ -->
                    <div id="timeDiffPanel" class="analysis-panel" style="display: none;">
                        <div class="config-group">
                            <label>èµ·å§‹ç‚¹è®¾ç½®</label>
                            <div style="display: flex; gap: 8px; margin-top: 8px;">
                                <button id="useZeroBtn" class="btn btn-primary" style="flex: 1;">ä½¿ç”¨0ç‚¹</button>
                                <button id="selectStartBtn" class="btn btn-secondary" style="flex: 1;">é€‰æ‹©å³°ä½</button>
                            </div>
                        </div>
                        
                        <div id="startPointInfo" class="info-box" style="margin-top: 10px;">
                            <p><strong>èµ·å§‹ç‚¹:</strong> <span id="startPointValue">0.0000 Î¼s</span></p>
                        </div>
                        
                        <p class="help-text">ç‚¹å‡»æ³¢å½¢ä¸Šçš„æ³¢å³°ä½ç½®æ¥æµ‹é‡æ—¶é—´å·®</p>
                        
                        <button id="selectEndBtn" class="btn btn-success btn-block">ç‚¹å‡»é€‰æ‹©æ³¢å³°</button>
                        <button id="clearTimeDiffBtn" class="btn btn-secondary btn-block">æ¸…é™¤æ ‡è®°</button>
                        
                        <div id="timeDiffResult" class="result-box" style="display: none;">
                            <p>èµ·å§‹ç‚¹: <span id="peak1Time">--</span> Î¼s</p>
                            <p>æ³¢å³°ä½ç½®: <span id="peak2Time">--</span> Î¼s</p>
                            <p class="highlight">æ—¶é—´å·®: <span id="timeDiff">--</span> Î¼s</p>
                        </div>
                    </div>
                    
                    <!-- äº’ç›¸å…³é¢æ¿ -->
                    <div id="crossCorrPanel" class="analysis-panel" style="display: none;">
                        <button id="selectMultipleFilesBtn" class="btn btn-primary btn-block">ğŸ“‚ é€‰æ‹©CSVæ–‡ä»¶</button>
                        <div id="fileListDisplay" class="info-box" style="margin-top: 10px; display: none;">
                            <p><strong>å·²é€‰æ‹©æ–‡ä»¶:</strong></p>
                            <div id="fileList" style="max-height: 60px; overflow-y: auto; font-size: 12px; line-height: 1.5;"></div>
                        </div>
                        <div class="config-group" id="referenceSelectGroup" style="display: none;">
                            <label>å‚è€ƒåŸºå‡†ä¿¡å·</label>
                            <select id="referenceSignalSelect" class="config-input">
                                <option value="">è¯·é€‰æ‹©å‚è€ƒä¿¡å·</option>
                            </select>
                        </div>
                        
                        <!-- ä¿¡å·æˆªå–èŒƒå›´ -->
                        <div class="config-group" id="truncateRangeGroup" style="display: none;">
                            <label>ä¿¡å·æˆªå–èŒƒå›´ (Î¼s)</label>
                            <div style="display: flex; gap: 8px; align-items: center;">
                                <div style="flex: 1;">
                                    <label style="font-size: 11px; color: #666;">èµ·å§‹æ—¶é—´</label>
                                    <input type="number" id="truncateStartInput" class="config-input" value="5.0" step="0.1" min="0" style="margin-top: 2px;">
                                </div>
                                <div style="flex: 1;">
                                    <label style="font-size: 11px; color: #666;">ç»“æŸæ—¶é—´</label>
                                    <input type="number" id="truncateEndInput" class="config-input" value="" placeholder="ä¸æˆªæ–­" step="0.1" min="0" style="margin-top: 2px;">
                                </div>
                            </div>
                            <p style="font-size: 11px; color: #666; margin-top: 4px; margin-bottom: 0;">
                                ğŸ’¡ æç¤ºï¼šèµ·å§‹æ—¶é—´é»˜è®¤5Î¼sï¼Œç»“æŸæ—¶é—´ç•™ç©ºè¡¨ç¤ºä¸æˆªæ–­å³ä¾§
                            </p>
                        </div>
                        
                        <button id="calculateCrossCorr" class="btn btn-success btn-block" disabled>ğŸ”¬ è®¡ç®—äº’ç›¸å…³</button>
                        <button id="exportCrossCorr" class="btn btn-secondary btn-block" disabled>ğŸ’¾ å¯¼å‡ºç»“æœ</button>
                        <div id="crossCorrStatus" class="info-box" style="margin-top: 10px; display: none;">
                            <p id="crossCorrStatusText">--</p>
                        </div>
                        
                        <!-- äº’ç›¸å…³ç»“æœæ˜¾ç¤º -->
                        <div id="crossCorrResultsDisplay" style="margin-top: 15px; display: none;">
                            <h4 style="margin-bottom: 10px; color: #333;">ğŸ“Š äº’ç›¸å…³ç»“æœ</h4>
                            <div id="crossCorrResultsList" style="max-height: 300px; overflow-y: auto;">
                                <!-- ç»“æœå°†åŠ¨æ€æ’å…¥è¿™é‡Œ -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æ³¢å½¢æ˜¾ç¤ºåŒºåŸŸ -->
                <div id="analysisDisplayArea" class="analysis-display-full">
                    <div class="waveform-header">
                        <!-- çŠ¶æ€æ ä¿¡æ¯é¢æ¿å ä½ -->
                        <div id="analysisStatusBarInfoPanel" class="status-bar-info-panel" style="display: none;">
                            <div id="analysisStatusBarInfoIcon" class="status-bar-info-icon">âœ…</div>
                            <div class="status-bar-info-content">
                                <div id="analysisStatusBarInfoText" class="status-bar-info-text">æ“ä½œæˆåŠŸ</div>
                                <div id="analysisStatusBarInfoDetail" class="status-bar-info-detail">è¯¦ç»†ä¿¡æ¯</div>
                            </div>
                        </div>
                        
                        <!-- å·¥å…·æ æŒ‰é’® -->
                        <div class="canvas-toolbar">
                            <button id="analysisScreenshotBtn" class="btn-icon" title="æˆªå›¾ä¿å­˜">ğŸ“·</button>
                            <button id="analysisPanBtn" class="btn-icon" title="æ‹–åŠ¨æ¨¡å¼ - ç‚¹å‡»å¯ç”¨åæ‹–åŠ¨æ³¢å½¢">âœ‹</button>
                            <button id="analysisZoomInBtn" class="btn-icon" title="æ¡†é€‰æ”¾å¤§ - ç‚¹å‡»å¯ç”¨åæ‹–åŠ¨é¼ æ ‡é€‰æ‹©åŒºåŸŸ">ğŸ”+</button>
                            <button id="analysisFitBtn" class="btn-icon" title="é€‚åº”çª—å£">â¬œ</button>
                            <button id="analysisResetBtn" class="btn-icon" title="é‡ç½® - æ¢å¤åŸå§‹è§†å›¾">ğŸ </button>
                        </div>
                    </div>
                    <div class="canvas-container" style="position: relative;">
                        <canvas id="analysisCanvas"></canvas>
                        <!-- å›¾ä¾‹ -->
                        <div id="analysisLegend" class="canvas-legend" style="display: none;">
                            <div class="legend-item">
                                <span class="legend-line" style="background: #2563eb;"></span>
                                <span class="legend-text">åŸå§‹ä¿¡å·</span>
                            </div>
                        </div>
                        <div id="analysisStatusMessage" class="status-message">è¯·é€‰æ‹©æ³¢å½¢æ–‡ä»¶</div>
                    </div>
                </div>
                


            </div>
        </div>

        <!-- åº”åŠ›ç³»æ•°æ ‡å®šå®éªŒé¡µé¢ -->
        <div id="calibrationTab" class="tab-content">
            <div class="stress-detection-container">
                <!-- å·¦ä¾§æ§åˆ¶é¢æ¿ -->
                <div class="stress-control-panel">
                    <!-- å®éªŒä¿¡æ¯ -->
                    <div class="config-section">
                        <h4 class="section-title">ğŸ“‹ å®éªŒä¿¡æ¯</h4>
                        <label class="config-label">ææ–™åç§°</label>
                        <input type="text" id="sd-materialName" class="config-input" placeholder="ä¾‹å¦‚: ç¢³çº¤ç»´å¤åˆææ–™æ¿">
                        
                        <label class="config-label">æµ‹è¯•æ–¹å‘</label>
                        <div style="display: flex; gap: 5px;">
                            <button id="sd-addDirectionBtn" class="btn btn-primary" style="flex: 1;">+ æ·»åŠ æ–¹å‘</button>
                            <button id="sd-manageExperimentsBtn" class="btn btn-secondary" style="flex: 1;">ğŸ“‚ å®éªŒç®¡ç†</button>
                        </div>
                        
                        <!-- ğŸ†• æ–¹å‘æ ‡ç­¾é¡µ -->
                        <div id="sd-directionTabs" class="direction-tabs" style="display: none;">
                            <!-- æ–¹å‘æ ‡ç­¾å°†åŠ¨æ€æ’å…¥è¿™é‡Œ -->
                        </div>
                    </div>
                    
                    <!-- å®éªŒå‚æ•° -->
                    <div class="config-section">
                        <h4 class="section-title" id="sd-paramTitle">âš™ï¸ å®éªŒå‚æ•°</h4>
                        <label class="config-label">åº”åŠ›èŒƒå›´ (MPa)</label>
                        <div class="input-group">
                            <input type="number" id="sd-stressMin" class="config-input-small" value="0" min="0">
                            <span>-</span>
                            <input type="number" id="sd-stressMax" class="config-input-small" value="100" min="0">
                        </div>
                        
                        <label class="config-label">åº”åŠ›æ­¥é•¿ (MPa)</label>
                        <input type="number" id="sd-stressStep" class="config-input" value="10" min="1">
                        
                        <button id="sd-toggleExperimentBtn" class="btn btn-primary btn-block">â–¶ï¸ å¼€å§‹å®éªŒ</button>
                    </div>
                    
                    <!-- æ•°æ®é‡‡é›† -->
                    <div class="config-section">
                        <h4 class="section-title" id="sd-captureTitle">ğŸ“¸ æ•°æ®é‡‡é›†</h4>
                        <button id="sd-captureBaselineBtn" class="btn btn-primary btn-block" disabled>é‡‡é›†åŸºå‡†æ³¢å½¢</button>
                        
                        <label class="config-label">å½“å‰åº”åŠ›ç‚¹ (MPa)</label>
                        <input type="number" id="sd-currentStress" class="config-input" value="0" min="0">
                        
                        <button id="sd-captureWaveformBtn" class="btn btn-success btn-block" disabled>é‡‡é›†æ³¢å½¢</button>
                        <button id="sd-endCaptureBtn" class="btn btn-secondary btn-block" disabled>é‡‡é›†ç»“æŸ</button>
                        <button id="sd-resetExperimentBtn" class="btn btn-danger btn-block" disabled>ğŸ”„ é‡ç½®å®éªŒ</button>
                    </div>
                    
                    <!-- æ•°æ®åˆ†æ -->
                    <div class="config-section">
                        <h4 class="section-title" id="sd-analysisTitle">ğŸ“Š æ•°æ®åˆ†æ</h4>
                        <button id="sd-fitCurveBtn" class="btn btn-primary btn-block" disabled>ç»˜åˆ¶æ‹Ÿåˆæ›²çº¿</button>
                        <button id="sd-exportDataBtn" class="btn btn-secondary btn-block" disabled>å¯¼å‡ºæ•°æ®</button>
                    </div>
                </div>
                
                <!-- å³ä¾§æ˜¾ç¤ºåŒºåŸŸ -->
                <div class="stress-display-area">
                    <!-- å®æ—¶æ³¢å½¢ç›‘æ§ -->
                    <div class="stress-monitor-section">
                        <div class="waveform-header">
                            <!-- å·¦ä¾§ï¼šä¿¡æ¯æ˜¾ç¤ºé¢æ¿ -->
                            <div id="sd-statusBarInfoPanel" class="status-bar-info-panel" style="display: none;">
                                <div id="sd-statusBarInfoIcon" class="status-bar-info-icon">âœ…</div>
                                <div class="status-bar-info-content">
                                    <div id="sd-statusBarInfoText" class="status-bar-info-text">æ“ä½œæˆåŠŸ</div>
                                    <div id="sd-statusBarInfoDetail" class="status-bar-info-detail">è¯¦ç»†ä¿¡æ¯</div>
                                </div>
                            </div>
                            
                            <!-- å³ä¾§ï¼šç›‘æ§æ§åˆ¶ -->
                            <div style="display: flex; gap: 10px; align-items: center; margin-left: auto;">
                                <button id="sd-startMonitorBtn" class="btn-monitor-compact" title="å¼€å§‹ç›‘æ§">â–¶ï¸</button>
                                <button id="sd-stopMonitorBtn" class="btn-monitor-compact btn-monitor-stop" title="åœæ­¢ç›‘æ§" style="display: none;">â¸ï¸</button>
                                <span id="sd-monitorStatus" class="monitor-status">æœªç›‘æ§</span>
                            </div>
                        </div>
                        <div class="canvas-container">
                            <canvas id="sd-monitorCanvas"></canvas>
                            <div id="sd-monitorMessage" class="status-message">ç‚¹å‡»"â–¶ï¸"å¼€å§‹ç›‘æ§</div>
                        </div>
                    </div>
                    
                    <!-- ä¸‹æ–¹åŒºåŸŸï¼šæ•°æ®è¡¨æ ¼ + æ‹Ÿåˆæ›²çº¿ -->
                    <div class="stress-bottom-section">
                        <!-- æ•°æ®è¡¨æ ¼ -->
                        <div class="stress-data-table">
                            <div class="table-header">
                                <span id="sd-tableTitle">æµ‹è¯•æ–¹å‘: --</span>
                            </div>
                            <div class="table-container">
                                <table id="sd-dataTable">
                                    <thead>
                                        <tr>
                                            <th>åº”åŠ›å€¼ (MPa)</th>
                                            <th>å£°æ—¶å·® (ns)</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="sd-dataTableBody">
                                        <tr>
                                            <td colspan="3" class="empty-message">æš‚æ— æ•°æ®</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- æ‹Ÿåˆæ›²çº¿å›¾ -->
                        <div class="stress-fit-curve">
                            <div class="curve-header">
                                <span>æ‹Ÿåˆæ›²çº¿</span>
                                <span id="sd-fitEquation" class="fit-equation">Î”t = -- Ïƒ + --</span>
                            </div>
                            <div class="canvas-container">
                                <canvas id="sd-fitCanvas"></canvas>
                                <div id="sd-fitMessage" class="status-message">è¯·å…ˆé‡‡é›†æ•°æ®</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å•è½´åº”åŠ›æ£€æµ‹é¡µé¢ - åº”åŠ›åœºæµ‹ç»˜ -->
        <div id="detectionTab" class="tab-content">
            <div class="field-mapping-container">
                <!-- å·¦ä¾§æ§åˆ¶æ  -->
                <div class="field-control-panel">
                    <!-- å®éªŒç®¡ç†åŒºï¼ˆå›ºå®šï¼‰ -->
                    <div class="field-experiment-section">
                        <div class="field-experiment-header">
                            <span id="field-experiment-name">æœªåŠ è½½å®éªŒ</span>
                            <span id="field-experiment-status" class="field-status-badge">--</span>
                        </div>
                        <div class="field-experiment-info">
                            <span>è¿›åº¦: <span id="field-experiment-progress">0/0</span></span>
                            <span>æ–¹å‘: <span id="field-stress-direction">--</span></span>
                            <span id="field-autosave-status"></span>
                        </div>
                        <div class="field-experiment-buttons">
                            <button id="field-new-experiment-btn" class="btn btn-primary btn-sm">ğŸ“‹ æ–°å»º</button>
                            <button id="field-manage-experiments-btn" class="btn btn-secondary btn-sm">ğŸ“ ç®¡ç†</button>
                            <button id="field-reset-experiment-btn" class="btn btn-danger btn-sm" disabled>ğŸ”„ é‡ç½®</button>
                        </div>
                    </div>
                    
                    <!-- æŠ˜å é¢æ¿åŒºåŸŸ -->
                    <div class="field-panels-container">
                        <!-- 1. æ ‡å®šæ•°æ®é¢æ¿ -->
                        <div class="field-panel" id="field-calibration-panel">
                            <div class="field-panel-header">
                                <span>ğŸ“ æ ‡å®šæ•°æ®</span>
                                <span id="field-calib-status" class="status-badge">âšª æœªåŠ è½½</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-radio-group">
                                    <label><input type="radio" name="field-calib-source" value="local" checked> æœ¬åœ°å®éªŒ</label>
                                    <label><input type="radio" name="field-calib-source" value="file"> æ–‡ä»¶å¯¼å…¥</label>
                                    <label><input type="radio" name="field-calib-source" value="manual"> æ‰‹åŠ¨è¾“å…¥</label>
                                </div>
                                <div id="field-calib-local-panel" class="field-calib-source-panel">
                                    <button id="field-calib-load-local" class="btn btn-primary btn-block btn-sm">é€‰æ‹©æ ‡å®šå®éªŒ</button>
                                </div>
                                <div id="field-calib-file-panel" class="field-calib-source-panel" style="display:none;">
                                    <button id="field-calib-load-file" class="btn btn-primary btn-block btn-sm">é€‰æ‹©æ–‡ä»¶</button>
                                </div>
                                <div id="field-calib-manual-panel" class="field-calib-source-panel" style="display:none;">
                                    <div class="form-group">
                                        <label>åº”åŠ›ç³»æ•° K (MPa/ns)</label>
                                        <input type="number" id="field-calib-manual-k" class="form-control" step="0.01" placeholder="ä¾‹å¦‚: 3.67">
                                    </div>
                                    <button id="field-calib-confirm-manual" class="btn btn-primary btn-block btn-sm">ç¡®è®¤</button>
                                </div>
                                <div id="field-calib-info" class="field-info-box"></div>
                            </div>
                        </div>
                        
                        <!-- 2. å½¢çŠ¶å®šä¹‰é¢æ¿ -->
                        <div class="field-panel" id="field-shape-panel">
                            <div class="field-panel-header">
                                <span>ğŸ“ è¯•ä»¶å½¢çŠ¶</span>
                                <span id="field-shape-status" class="status-badge">âšª æœªè®¾ç½®</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-radio-group">
                                    <label><input type="radio" name="field-shape-type" value="rectangle" checked> çŸ©å½¢</label>
                                    <label><input type="radio" name="field-shape-type" value="circle"> åœ†å½¢</label>
                                    <label><input type="radio" name="field-shape-type" value="polygon"> å¤šè¾¹å½¢</label>
                                </div>
                                <!-- çŸ©å½¢å‚æ•° -->
                                <div id="field-shape-rectangle-params" class="field-shape-params">
                                    <div class="form-row">
                                        <div class="form-group"><label>å®½åº¦(mm)</label><input type="number" id="field-shape-rect-width" class="form-control field-shape-param" value="100"></div>
                                        <div class="form-group"><label>é«˜åº¦(mm)</label><input type="number" id="field-shape-rect-height" class="form-control field-shape-param" value="100"></div>
                                    </div>
                                </div>
                                <!-- åœ†å½¢å‚æ•° -->
                                <div id="field-shape-circle-params" class="field-shape-params" style="display:none;">
                                    <div class="form-row">
                                        <div class="form-group"><label>åœ†å¿ƒX</label><input type="number" id="field-shape-circle-cx" class="form-control field-shape-param" value="50"></div>
                                        <div class="form-group"><label>åœ†å¿ƒY</label><input type="number" id="field-shape-circle-cy" class="form-control field-shape-param" value="50"></div>
                                    </div>
                                    <div class="form-group"><label>åŠå¾„(mm)</label><input type="number" id="field-shape-circle-radius" class="form-control field-shape-param" value="50"></div>
                                </div>
                                <!-- å¤šè¾¹å½¢å‚æ•° -->
                                <div id="field-shape-polygon-params" class="field-shape-params" style="display:none;">
                                    <div class="form-group">
                                        <label>é¡¶ç‚¹åæ ‡ (æ¯è¡Œä¸€ä¸ª: x,y)</label>
                                        <textarea id="field-shape-polygon-vertices" class="form-control field-shape-param" rows="4" placeholder="0,0&#10;100,0&#10;100,100&#10;0,100"></textarea>
                                    </div>
                                </div>
                                <!-- å¸ƒå°”è¿ç®— -->
                                <div class="field-modifiers-section">
                                    <div class="field-modifiers-header">
                                        <span>å­”æ´/ç¼ºå£</span>
                                        <button id="field-shape-add-hole" class="btn btn-sm">+ æ·»åŠ </button>
                                    </div>
                                    <div id="field-shape-modifiers" class="field-modifiers-list"><div class="empty">æ— å­”æ´/ç¼ºå£</div></div>
                                </div>
                                <div class="field-panel-actions">
                                    <button id="field-shape-validate" class="btn btn-secondary btn-sm">éªŒè¯</button>
                                    <button id="field-shape-apply" class="btn btn-primary btn-sm">åº”ç”¨</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 3. å¸ƒç‚¹è®¾ç½®é¢æ¿ -->
                        <div class="field-panel" id="field-layout-panel">
                            <div class="field-panel-header">
                                <span>ğŸ“ æµ‹ç‚¹å¸ƒå±€</span>
                                <span id="field-layout-status" class="status-badge">âšª æœªç”Ÿæˆ</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-radio-group">
                                    <label><input type="radio" name="field-layout-type" value="grid" checked> ç½‘æ ¼</label>
                                    <label><input type="radio" name="field-layout-type" value="polar"> æåæ ‡</label>
                                    <label><input type="radio" name="field-layout-type" value="custom"> è‡ªå®šä¹‰</label>
                                </div>
                                <!-- ç½‘æ ¼å‚æ•° -->
                                <div id="field-layout-grid-params" class="field-layout-params">
                                    <div class="form-row">
                                        <div class="form-group"><label>è¡Œæ•°</label><input type="number" id="field-layout-grid-rows" class="form-control" value="5" min="1"></div>
                                        <div class="form-group"><label>åˆ—æ•°</label><input type="number" id="field-layout-grid-cols" class="form-control" value="5" min="1"></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group">
                                            <label>è¡Œé—´è·(mm)</label>
                                            <div class="field-margin-display">
                                                <span id="field-layout-row-spacing-display">--</span>
                                                <button type="button" id="field-layout-row-spacing-btn" class="btn btn-secondary btn-xs">å˜è·</button>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label>åˆ—é—´è·(mm)</label>
                                            <div class="field-margin-display">
                                                <span id="field-layout-col-spacing-display">--</span>
                                                <button type="button" id="field-layout-col-spacing-btn" class="btn btn-secondary btn-xs">å˜è·</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label>è¾¹è·(mm)</label>
                                        <div class="field-margin-display">
                                            <span id="field-layout-margin-display">ç»Ÿä¸€: 10</span>
                                            <button type="button" id="field-layout-margin-btn" class="btn btn-secondary btn-xs">è®¾ç½®</button>
                                        </div>
                                    </div>
                                    <!-- éšè—çš„è¾¹è·å€¼å­˜å‚¨ -->
                                    <input type="hidden" id="field-layout-grid-margin-top" value="10">
                                    <input type="hidden" id="field-layout-grid-margin-bottom" value="10">
                                    <input type="hidden" id="field-layout-grid-margin-left" value="10">
                                    <input type="hidden" id="field-layout-grid-margin-right" value="10">
                                    <input type="hidden" id="field-layout-margin-mode" value="uniform">
                                    <!-- éšè—çš„é—´è·å€¼å­˜å‚¨ -->
                                    <input type="hidden" id="field-layout-row-spacing-mode" value="uniform">
                                    <input type="hidden" id="field-layout-row-spacing-value" value="10">
                                    <input type="hidden" id="field-layout-row-spacing-array" value="">
                                    <input type="hidden" id="field-layout-col-spacing-mode" value="uniform">
                                    <input type="hidden" id="field-layout-col-spacing-value" value="10">
                                    <input type="hidden" id="field-layout-col-spacing-array" value="">
                                </div>
                                <!-- æåæ ‡å‚æ•° -->
                                <div id="field-layout-polar-params" class="field-layout-params" style="display:none;">
                                    <div class="form-row">
                                        <div class="form-group"><label>åœ†å¿ƒX</label><input type="number" id="field-layout-polar-cx" class="form-control" value="50"></div>
                                        <div class="form-group"><label>åœ†å¿ƒY</label><input type="number" id="field-layout-polar-cy" class="form-control" value="50"></div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group"><label>èµ·å§‹åŠå¾„</label><input type="number" id="field-layout-polar-rstart" class="form-control" value="0" min="0"></div>
                                        <div class="form-group">
                                            <label>åŠå¾„æ­¥é•¿</label>
                                            <div style="display:flex;gap:5px;">
                                                <input type="number" id="field-layout-polar-rstep" class="form-control" value="10" min="1">
                                                <button id="field-layout-polar-rstep-btn" class="btn btn-secondary btn-sm" title="æ¯å±‚ä¸åŒåŠå¾„æ­¥é•¿">å˜</button>
                                            </div>
                                            <input type="hidden" id="field-layout-polar-rstep-mode" value="uniform">
                                            <input type="hidden" id="field-layout-polar-rstep-array" value="">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group"><label>å±‚æ•°</label><input type="number" id="field-layout-polar-rcount" class="form-control" value="4" min="1"></div>
                                        <div class="form-group">
                                            <label>æ¯å±‚ç‚¹æ•°</label>
                                            <div style="display:flex;gap:5px;">
                                                <input type="number" id="field-layout-polar-ppr" class="form-control" value="8" min="1">
                                                <button id="field-layout-polar-ppr-btn" class="btn btn-secondary btn-sm" title="æ¯å±‚ä¸åŒç‚¹æ•°">å˜</button>
                                            </div>
                                            <input type="hidden" id="field-layout-polar-ppr-mode" value="uniform">
                                            <input type="hidden" id="field-layout-polar-ppr-array" value="">
                                        </div>
                                    </div>
                                    <div class="form-row">
                                        <div class="form-group"><label>èµ·å§‹è§’åº¦</label><input type="number" id="field-layout-polar-astart" class="form-control" value="0"></div>
                                        <div class="form-group"><label>ç»“æŸè§’åº¦</label><input type="number" id="field-layout-polar-aend" class="form-control" value="360"></div>
                                    </div>
                                </div>
                                <!-- è‡ªå®šä¹‰å‚æ•° -->
                                <div id="field-layout-custom-params" class="field-layout-params" style="display:none;">
                                    <button id="field-layout-import" class="btn btn-primary btn-block btn-sm">ğŸ“‚ å¯¼å…¥CSV</button>
                                </div>
                                <div class="field-panel-actions">
                                    <button id="field-layout-generate" class="btn btn-primary btn-sm">ç”Ÿæˆæµ‹ç‚¹</button>
                                    <button id="field-layout-optimize" class="btn btn-secondary btn-sm">ä¼˜åŒ–é¡ºåº</button>
                                    <button id="field-layout-clear" class="btn btn-danger btn-sm">æ¸…ç©º</button>
                                </div>
                                <div class="field-layout-info">æµ‹ç‚¹æ•°: <span id="field-layout-count">0</span></div>
                            </div>
                        </div>
                        
                        <!-- 4. åŸºå‡†æ³¢å½¢ç®¡ç†é¢æ¿ -->
                        <div class="field-panel" id="field-baseline-panel">
                            <div class="field-panel-header">
                                <span>ğŸ“Š åŸºå‡†æ³¢å½¢ç®¡ç†</span>
                                <span id="field-baseline-status" class="status-badge">âšª æœªè®¾ç½®</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-baseline-info">
                                    <div class="field-info-item">
                                        <span class="label">å½“å‰åŸºå‡†ç‚¹:</span>
                                        <span id="field-baseline-point-id" class="value">--</span>
                                    </div>
                                    <div class="field-info-item">
                                        <span class="label">é‡‡é›†æ—¶é—´:</span>
                                        <span id="field-baseline-time" class="value">--</span>
                                    </div>
                                    <div class="field-info-item">
                                        <span class="label">ä¿¡å™ªæ¯”:</span>
                                        <span id="field-baseline-snr" class="value">--</span>
                                    </div>
                                    <div class="field-info-item">
                                        <span class="label">è´¨é‡è¯„åˆ†:</span>
                                        <span id="field-baseline-quality" class="value">--</span>
                                    </div>
                                </div>
                                <div class="field-panel-actions">
                                    <button id="field-baseline-view" class="btn btn-secondary btn-sm">ğŸ‘ï¸ æŸ¥çœ‹æ³¢å½¢</button>
                                    <button id="field-baseline-change" class="btn btn-primary btn-sm">ğŸ”„ æ›´æ¢åŸºå‡†ç‚¹</button>
                                </div>
                                
                                <!-- åº”åŠ›è®¡ç®—æ¨¡å¼ -->
                                <div class="field-stress-mode-section">
                                    <div class="section-divider"></div>
                                    <div class="field-stress-mode-title">åº”åŠ›è®¡ç®—æ¨¡å¼:</div>
                                    <div class="field-stress-mode-options">
                                        <label class="field-radio-option">
                                            <input type="radio" name="field-stress-mode" value="relative" checked>
                                            <span class="radio-label">ç›¸å¯¹åº”åŠ›æ¨¡å¼ï¼ˆåŸºå‡†ç‚¹ = 0 MPaï¼‰</span>
                                        </label>
                                        <label class="field-radio-option">
                                            <input type="radio" name="field-stress-mode" value="absolute">
                                            <span class="radio-label">ç»å¯¹åº”åŠ›æ¨¡å¼</span>
                                        </label>
                                    </div>
                                    <div id="field-absolute-stress-input" class="field-absolute-stress-input" style="display: none;">
                                        <label class="field-input-label">
                                            åŸºå‡†ç‚¹åº”åŠ›å€¼ (MPa):
                                            <input type="number" id="field-baseline-stress-value" value="0" step="0.1">
                                        </label>
                                        <div class="field-input-hint">ğŸ’¡ æ­£å€¼=æ‹‰åº”åŠ›ï¼Œè´Ÿå€¼=å‹åº”åŠ›</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 5. è´¨é‡æ£€æŸ¥æ¨¡å¼é¢æ¿ -->
                        <div class="field-panel" id="field-quality-panel">
                            <div class="field-panel-header">
                                <span>ğŸ” è´¨é‡æ£€æŸ¥æ¨¡å¼</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-quality-mode-selector">
                                    <div class="field-quality-mode-card selected" data-mode="strict">
                                        <div class="mode-icon">ğŸ”</div>
                                        <div class="mode-title">ä¸¥æ ¼æ¨¡å¼</div>
                                        <div class="mode-desc">ç²¾ç»†æµ‹é‡</div>
                                    </div>
                                    <div class="field-quality-mode-card" data-mode="fast">
                                        <div class="mode-icon">âš¡</div>
                                        <div class="mode-title">å¿«é€Ÿæ¨¡å¼</div>
                                        <div class="mode-desc">ç²—ç•¥æµ‹é‡</div>
                                    </div>
                                </div>
                                <div id="field-quality-features-strict" class="field-quality-features">
                                    <div class="feature-item"><span class="check">âœ“</span> å®æ—¶è´¨é‡è¯„ä¼°</div>
                                    <div class="feature-item"><span class="check">âœ“</span> è´¨é‡ä¸åˆæ ¼æ—¶å¼¹å‡ºè­¦å‘Š</div>
                                    <div class="feature-item"><span class="check">âœ“</span> å¯é€‰æ‹©é‡æµ‹æˆ–è·³è¿‡</div>
                                </div>
                                <div id="field-quality-features-fast" class="field-quality-features" style="display: none;">
                                    <div class="feature-item"><span class="check">âœ“</span> å®æ—¶è´¨é‡è¯„ä¼°</div>
                                    <div class="feature-item"><span class="check">âœ“</span> ä»…æ˜¾ç¤ºç®€çŸ­æç¤º</div>
                                    <div class="feature-item"><span class="check">âœ“</span> è‡ªåŠ¨ç»§ç»­ä¸‹ä¸€æµ‹ç‚¹</div>
                                </div>
                                <div id="field-quality-mode-desc" class="field-quality-mode-description">
                                    é€‚åˆæ­£å¼å®éªŒå’Œé«˜ç²¾åº¦æµ‹é‡
                                </div>
                            </div>
                        </div>
                        
                        <!-- 6. é‡‡é›†æ§åˆ¶é¢æ¿ -->
                        <div class="field-panel" id="field-capture-panel">
                            <div class="field-panel-header">
                                <span>ğŸ“¸ æ•°æ®é‡‡é›†</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-capture-global-controls">
                                    <button id="field-capture-start-pause" class="btn btn-primary">â–¶ï¸ å¼€å§‹é‡‡é›†</button>
                                    <button id="field-capture-finish" class="btn btn-secondary">âœ… å®Œæˆé‡‡é›†</button>
                                </div>
                                <div class="field-progress-bar-container">
                                    <div id="field-capture-progress-bar" class="field-progress-bar"></div>
                                </div>
                                <div class="field-current-point">
                                    <div class="field-point-info">
                                        <span>å½“å‰æµ‹ç‚¹: <strong id="field-capture-point-id">--</strong> <span id="field-capture-point-type"></span></span>
                                        <span>ä½ç½®: (<span id="field-capture-point-x">--</span>, <span id="field-capture-point-y">--</span>)</span>
                                    </div>
                                    <div class="field-point-nav">
                                        <button id="field-capture-prev" class="btn btn-sm">â—€</button>
                                        <input type="number" id="field-capture-jump-input" class="point-jump-input" min="1" value="0" />
                                        <span> / </span>
                                        <span id="field-capture-total">0</span>
                                        <button id="field-capture-next" class="btn btn-sm">â–¶</button>
                                        <button id="field-capture-jump-btn" class="btn btn-sm" title="è·³è½¬åˆ°æŒ‡å®šæµ‹ç‚¹">ğŸ”</button>
                                    </div>
                                </div>
                                <div class="field-capture-actions">
                                    <button id="field-capture-current" class="btn btn-primary btn-block" disabled>ğŸ“¸ é‡‡é›†å½“å‰æµ‹ç‚¹</button>
                                    <div class="field-capture-secondary">
                                        <button id="field-capture-skip" class="btn btn-secondary btn-sm" disabled>è·³è¿‡</button>
                                        <button id="field-capture-recapture" class="btn btn-secondary btn-sm" disabled>é‡æµ‹</button>
                                        <button id="field-capture-set-baseline" class="btn btn-secondary btn-sm" disabled>è®¾ä¸ºåŸºå‡†</button>
                                    </div>
                                </div>
                                <div class="field-capture-options">
                                    <label><input type="checkbox" id="field-capture-auto-denoise" checked> è‡ªåŠ¨é™å™ª</label>
                                    <button id="field-capture-denoise-settings" class="btn btn-sm">âš™ï¸</button>
                                </div>
                                <div class="field-capture-result">
                                    <div class="result-item"><span>æ—¶é—´å·®:</span><span id="field-capture-result-timediff">--</span> ns</div>
                                    <div class="result-item"><span>åº”åŠ›:</span><span id="field-capture-result-stress">--</span> MPa</div>
                                    <div class="result-item"><span>è´¨é‡:</span><span id="field-capture-result-quality">--</span></div>
                                    <div class="result-item"><span>SNR:</span><span id="field-capture-result-snr">--</span> dB</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 7. äº‘å›¾è®¾ç½®é¢æ¿ -->
                        <div class="field-panel" id="field-contour-settings-panel">
                            <div class="field-panel-header">
                                <span>ğŸ—ºï¸ äº‘å›¾è®¾ç½®</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-form-group">
                                    <label>æ’å€¼æ–¹æ³•</label>
                                    <select id="field-contour-interpolation" class="field-select">
                                        <option value="auto">è‡ªåŠ¨é€‰æ‹©</option>
                                        <option value="linear">çº¿æ€§æ’å€¼</option>
                                        <option value="cubic">ä¸‰æ¬¡æ’å€¼</option>
                                    </select>
                                </div>
                                <div class="field-form-group">
                                    <label>åˆ†è¾¨ç‡</label>
                                    <select id="field-contour-resolution" class="field-select">
                                        <option value="50">ä½ (50Ã—50)</option>
                                        <option value="100" selected>ä¸­ (100Ã—100)</option>
                                        <option value="200">é«˜ (200Ã—200)</option>
                                    </select>
                                </div>
                                <div class="field-form-group">
                                    <label>è‰²æ ‡èŒƒå›´ (MPa)</label>
                                    <div class="field-input-row">
                                        <input type="number" id="field-contour-min" class="field-input-sm" placeholder="è‡ªåŠ¨">
                                        <span>~</span>
                                        <input type="number" id="field-contour-max" class="field-input-sm" placeholder="è‡ªåŠ¨">
                                    </div>
                                </div>
                                <div class="field-checkbox-group">
                                    <label><input type="checkbox" id="field-contour-show-points" checked> æ˜¾ç¤ºæµ‹ç‚¹</label>
                                    <label><input type="checkbox" id="field-contour-show-contour-lines"> æ˜¾ç¤ºç­‰é«˜çº¿</label>
                                    <label><input type="checkbox" id="field-contour-auto-update" checked> è‡ªåŠ¨æ›´æ–°</label>
                                </div>
                                <div class="field-panel-actions">
                                    <button id="field-contour-refresh" class="btn btn-primary btn-sm">ğŸ”„ åˆ·æ–°äº‘å›¾</button>
                                    <button id="field-contour-export" class="btn btn-secondary btn-sm">ğŸ“· å¯¼å‡ºå›¾ç‰‡</button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 8. æ•°æ®å¯¼å‡ºé¢æ¿ -->
                        <div class="field-panel" id="field-export-panel">
                            <div class="field-panel-header">
                                <span>ğŸ“¤ æ•°æ®å¯¼å‡º</span>
                            </div>
                            <div class="field-panel-body">
                                <div class="field-form-group">
                                    <label>å¯¼å‡ºæ ¼å¼</label>
                                    <select id="field-export-format" class="field-select">
                                        <option value="csv">CSV (æµ‹ç‚¹æ•°æ®)</option>
                                        <option value="excel">Excel (å®Œæ•´æŠ¥å‘Š)</option>
                                        <option value="hdf5">HDF5 (å«æ³¢å½¢)</option>
                                    </select>
                                </div>
                                <div class="field-checkbox-group">
                                    <label><input type="checkbox" id="field-export-include-waveforms"> åŒ…å«æ³¢å½¢æ•°æ®</label>
                                    <label><input type="checkbox" id="field-export-include-contour" checked> åŒ…å«äº‘å›¾</label>
                                    <label><input type="checkbox" id="field-export-include-stats" checked> åŒ…å«ç»Ÿè®¡</label>
                                </div>
                                <div class="field-panel-actions">
                                    <button id="field-export-btn" class="btn btn-primary btn-block btn-sm">ğŸ“¥ å¯¼å‡ºæ•°æ®</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- å³ä¾§æ˜¾ç¤ºåŒº -->
                <div class="field-display-area">
                    <!-- ä¸ŠåŠåŒºï¼šæ•°æ®è¡¨æ ¼ + æ³¢å½¢ -->
                    <div class="field-top-section">
                        <!-- æ•°æ®è¡¨æ ¼ -->
                        <div class="field-data-table-container">
                            <div class="field-table-header">
                                <span>ğŸ“Š æµ‹ç‚¹æ•°æ®</span>
                                <div class="field-table-actions">
                                    <button class="btn btn-sm" onclick="FieldExperimentManager.å¯¼å‡ºå®éªŒ(StressDetectionUniaxialModule.è·å–å½“å‰å®éªŒ()?.experiment_id)">ğŸ“¤ å¯¼å‡º</button>
                                </div>
                            </div>
                            <div class="field-table-wrapper">
                                <table id="field-data-table">
                                    <thead>
                                        <tr>
                                            <th>ç¼–å·</th>
                                            <th>X(mm)</th>
                                            <th>Y(mm)</th>
                                            <th>Î”t(ns)</th>
                                            <th>Ïƒ(MPa)</th>
                                            <th>è´¨é‡</th>
                                            <th>æ“ä½œ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="field-data-table-body">
                                        <tr><td colspan="7" style="text-align:center;color:#999;">æš‚æ— æµ‹ç‚¹æ•°æ®</td></tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <!-- æ³¢å½¢æ˜¾ç¤º -->
                        <div class="field-waveform-container">
                            <div class="field-waveform-header">
                                <span>å®æ—¶æ³¢å½¢</span>
                                <div style="display: flex; gap: 8px; align-items: center;">
                                    <button id="field-waveform-start" class="btn-monitor-compact" title="å¼€å§‹ç›‘æ§">â–¶ï¸</button>
                                    <button id="field-waveform-stop" class="btn-monitor-compact btn-monitor-stop" title="åœæ­¢ç›‘æ§" style="display: none;">â¸ï¸</button>
                                    <span id="field-waveform-status" class="monitor-status">æœªç›‘æ§</span>
                                </div>
                            </div>
                            <canvas id="field-waveform-canvas"></canvas>
                        </div>
                    </div>
                    
                    <!-- ä¸Šä¸‹æ‹–æ‹½åˆ†å‰²æ¡ -->
                    <div class="field-resize-handle field-resize-vertical" id="field-resize-vertical"></div>
                    
                    <!-- ä¸‹åŠåŒºï¼šé¢„è§ˆç”»å¸ƒ + äº‘å›¾ -->
                    <div class="field-bottom-section">
                        <!-- é¢„è§ˆç”»å¸ƒ -->
                        <div class="field-preview-container" id="field-preview-container">
                            <div class="field-canvas-header field-collapsible-header" data-target="preview">
                                <span>ğŸ“ æµ‹ç‚¹é¢„è§ˆ</span>
                                <span class="collapse-icon">â–¼</span>
                            </div>
                            <canvas id="field-preview-canvas"></canvas>
                        </div>
                        <!-- äº‘å›¾æ˜¾ç¤º -->
                        <div class="field-contour-container" id="field-contour-container">
                            <div class="field-canvas-header field-collapsible-header" data-target="contour">
                                <span>ğŸŒˆ åº”åŠ›äº‘å›¾</span>
                                <span class="collapse-icon">â–¼</span>
                            </div>
                            <canvas id="field-contour-canvas"></canvas>
                        </div>
                    </div>
                </div>
                
                <!-- çŠ¶æ€æ  -->
                <div id="field-status-bar" class="field-status-bar" style="display:none;">
                    <span id="field-status-icon"></span>
                    <span id="field-status-text"></span>
                    <span id="field-status-detail"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- ğŸ†• å®éªŒç®¡ç†å¯¹è¯æ¡† -->
    <div id="experimentManagerModal" class="modal" style="display: none;">
        <div class="modal-content field-modal modal-lg" style="max-height: 80vh;">
            <div class="modal-header">
                <h3>ğŸ“‚ å®éªŒæ•°æ®ç®¡ç†</h3>
                <div style="display: flex; align-items: center; gap: 10px;">
                    <button class="btn btn-primary btn-sm" onclick="StressCalibrationModule.å¯¼å‡ºå…¨éƒ¨æ•°æ®()">ğŸ“Š å¯¼å‡ºå…¨éƒ¨</button>
                    <button id="deleteAllDataBtn" class="btn btn-danger btn-sm" onclick="StressCalibrationModule.åˆ é™¤å…¨éƒ¨æ•°æ®()">ğŸ—‘ï¸ åˆ é™¤å…¨éƒ¨</button>
                    <button class="modal-close" onclick="StressCalibrationModule.å…³é—­å®éªŒç®¡ç†å¯¹è¯æ¡†()">Ã—</button>
                </div>
            </div>
            <div class="modal-body" style="max-height: 55vh;">
                <div id="experimentListContainer">
                    <p style="text-align: center; color: #999;">åŠ è½½ä¸­...</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="StressCalibrationModule.å…³é—­å®éªŒç®¡ç†å¯¹è¯æ¡†()">å…³é—­</button>
            </div>
        </div>
    </div>

    <!-- ğŸ†• è‡ªå®šä¹‰è¾“å…¥å¯¹è¯æ¡† -->
    <div id="customPromptModal" class="modal" style="display: none;">
        <div class="modal-content field-modal modal-sm">
            <div class="modal-header">
                <h3 id="customPromptTitle">è¾“å…¥</h3>
                <button class="modal-close" onclick="window.closeCustomPrompt()">Ã—</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label id="customPromptMessage" style="color: #666;"></label>
                    <input type="text" id="customPromptInput" class="form-input">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="window.closeCustomPrompt()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="window.confirmCustomPrompt()">ç¡®å®š</button>
            </div>
        </div>
    </div>



    <!-- å¼€å±ç”»é¢æ§åˆ¶è„šæœ¬ -->
    <script>
        // éšè—å¼€å±ç”»é¢çš„å‡½æ•°
        window.hideSplash = function() {
            const splash = document.getElementById('splashScreen');
            if (splash) {
                splash.classList.add('hidden');
                // åŠ¨ç”»ç»“æŸåç§»é™¤å…ƒç´ ï¼ˆ0.5ç§’ï¼‰
                setTimeout(() => {
                    splash.remove();
                }, 500);
            }
        };
    </script>
    
    <!-- æ¨¡å—åŒ– JavaScript -->
    <script src="js/common.js"></script>
    <!-- å®æ—¶é‡‡é›†æ¨¡å— -->
    <script src="js/realtime-capture/realtime-capture.js"></script>
    <!-- æ³¢å½¢åˆ†ææ¨¡å—ï¼ˆæŒ‰ä¾èµ–é¡ºåºåŠ è½½ï¼‰-->
    <script src="js/waveform-analysis/waveform-drawing.js"></script>
    <script src="js/waveform-analysis/waveform-zoom.js"></script>
    <script src="js/waveform-analysis/waveform-processing.js"></script>
    <script src="js/waveform-analysis/waveform-crosscorr.js"></script>
    <script src="js/waveform-analysis/waveform-analysis.js"></script>
    <!-- åº”åŠ›ç³»æ•°æ ‡å®šæ¨¡å— -->
    <script src="js/stress-calibration/stress-calibration-manager.js"></script>
    <script src="js/stress-calibration/stress-calibration-capture.js"></script>
    <script src="js/stress-calibration/stress-calibration.js"></script>
    <!-- å•è½´åº”åŠ›æ£€æµ‹æ¨¡å— - åº”åŠ›åœºæµ‹ç»˜ -->
    <script src="js/stress-detection-uniaxial/field-canvas.js"></script>
    <script src="js/stress-detection-uniaxial/field-contour.js"></script>
    <script src="js/stress-detection-uniaxial/field-resizer.js"></script>
    <script src="js/stress-detection-uniaxial/field-calibration-panel.js"></script>
    <script src="js/stress-detection-uniaxial/field-shape-panel.js"></script>
    <script src="js/stress-detection-uniaxial/field-layout-panel.js"></script>
    <script src="js/stress-detection-uniaxial/field-capture-panel.js"></script>
    <script src="js/stress-detection-uniaxial/field-experiment-manager.js"></script>
    <script src="js/stress-detection-uniaxial/stress-detection-uniaxial.js"></script>
    <script src="js/main.js"></script>
</body>
</html>
